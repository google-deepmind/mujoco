From 708206b28f34c0b1e495f9406888bd14d8a7e565 Mon Sep 17 00:00:00 2001
From: MatiasManevi <manevimatias@gmail.com>
Date: Wed, 8 Oct 2025 17:17:34 -0300
Subject: [PATCH 1/2] Add library only if not emcc

---
 CMakeLists.txt | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 0423820..0075bc2 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -360,6 +360,7 @@ if (NOT DEFINED CMAKE_BUILD_WITH_INSTALL_RPATH)
     set(CMAKE_BUILD_WITH_INSTALL_RPATH FALSE)
 endif ()

+if (NOT EMSCRIPTEN)
 add_library(${qhull_SHAREDR} SHARED
         ${libqhullr_SOURCES}
         src/libqhull_r/qhull_r-exports.def)
@@ -420,7 +421,7 @@ set_target_properties(${qhull_SHAREDP} PROPERTIES
 if(UNIX)
     target_link_libraries(${qhull_SHAREDP} m)
 endif(UNIX)
-
+endif (NOT EMSCRIPTEN)
 # ---------------------------------------
 # Define static libraries qhullstatic (non-reentrant) and qhullstatic_r (reentrant)
 # ---------------------------------------

From 2d32ef4911b0a8ed443f480e3b5960ae95cb429c Mon Sep 17 00:00:00 2001
From: MatiasManevi <manevimatias@gmail.com>
Date: Wed, 8 Oct 2025 17:34:56 -0300
Subject: [PATCH 2/2] set target props if not emcc

---
 CMakeLists.txt | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index 0075bc2..c5295c1 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -476,7 +476,7 @@ if(NOT ${BUILD_STATIC_LIBS})
     set_target_properties(${qhull_STATICR} PROPERTIES EXCLUDE_FROM_ALL TRUE)
     set_target_properties(${qhull_CPP} PROPERTIES EXCLUDE_FROM_ALL TRUE)
 endif()
-if(NOT ${BUILD_SHARED_LIBS})
+if(NOT ${BUILD_SHARED_LIBS} AND NOT EMSCRIPTEN)
     set_target_properties(${qhull_SHARED} PROPERTIES EXCLUDE_FROM_ALL TRUE)
     set_target_properties(${qhull_SHAREDR} PROPERTIES EXCLUDE_FROM_ALL TRUE)
     set_target_properties(${qhull_SHAREDP} PROPERTIES EXCLUDE_FROM_ALL TRUE)
