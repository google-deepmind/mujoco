load("//test:helper.bzl", "PLUGIN_DIR")

cc_test(
    name = "engine_test",
    size = "small",
    srcs = [
        "engine_collision_box_test.cc",
        "engine_collision_convex_test.cc",
        "engine_collision_driver_test.cc",
        "engine_collision_gjk_test.cc",
        "engine_collision_sdf_test.cc",
        "engine_core_constraint_test.cc",
        "engine_core_smooth_test.cc",
        "engine_derivative_test.cc",
        "engine_forward_test.cc",
        "engine_inverse_test.cc",
        "engine_io_test.cc",
        "engine_island_test.cc",
        "engine_passive_test.cc",
        "engine_plugin_test.cc",
        "engine_print_test.cc",
        "engine_ray_test.cc",
        "engine_sensor_test.cc",
        "engine_solver_test.cc",
        "engine_sort_test.cc",
        "engine_support_test.cc",
        "engine_thread_test.cc",
        "engine_util_blas_test.cc",
        "engine_util_container_test.cc",
        "engine_util_errmem_test.cc",
        "engine_util_misc_test.cc",
        "engine_util_solve_test.cc",
        "engine_util_sparse_test.cc",
        "engine_util_spatial_test.cc",
        "engine_vis_state_test.cc",
        "engine_vis_visualize_test.cc",
    ],
    copts = [
        "-Wno-dangling-else",
        "-Wno-unknown-pragmas",
        "-Wno-unused-function",
        "-Wno-sign-compare",
        "-Isrc",
    ] + select({
        "//tools:gcc": [
            "-Wno-maybe-uninitialized",
        ],
        "//conditions:default": [],
    }),
    data = [
        "//:model_data",
        "//:test_data_stripped",
        "//:test_engine_data_stripped",
    ],
    env = PLUGIN_DIR,
    deps = [
        "//:mujoco",
        "//src/engine:engine_util_container",
        "//src/engine:engine_util_sparse",
        "//test:fixture",
        "@googletest//:gtest_main",
    ],
    linkstatic=True,
)
